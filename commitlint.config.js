/*
ĞœĞ¾Ğ´ĞµĞ»ÑŒ ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ° Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ:
<type>(<scope?>): <subject!>
<BLANK LINE>
<body?>
<BLANK LINE>
<footer?>

Default types:
build: Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ, Ğ·Ğ°Ñ‚Ñ€Ğ°Ğ³Ğ¸Ğ²Ğ°ÑÑ‰Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ÑĞ±Ğ¾Ñ€ĞºĞ¸ Ğ¸Ğ»Ğ¸ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
ci: Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ÑĞ»ÑƒĞ¶Ğ± Ğ½ĞµĞ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ
chore: Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ³Ñ€ÑƒĞ±Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸ Ñ‚.Ğ´.; Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ°
docs: Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸
feat: Ğ½Ğ¾Ğ²Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ
fix: Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
perf: Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ°, Ğ¿Ğ¾Ğ²Ñ‹ÑˆĞ°ÑÑ‰ĞµĞµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
refactor: Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ½Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ğ¸ Ğ½Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ½Ğ¾Ğ²ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ.
style: Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ, Ğ½Ğµ Ğ²Ğ»Ğ¸ÑÑÑ‰Ğ¸Ğµ Ğ½Ğ° ÑĞ¼Ñ‹ÑĞ» ĞºĞ¾Ğ´Ğ° (Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹, Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ, Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ñ‚Ğ¾Ñ‡ĞµĞº Ñ Ğ·Ğ°Ğ¿ÑÑ‚Ğ¾Ğ¹ Ğ¸ Ñ‚. Ğ´.)
test: Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¸Ğ»Ğ¸ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²

scope - Ğ¸Ğ¼Ñ Ğ¾Ğ±Ğ»Ğ°ÑÑ‚Ğ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ (Ñ‡Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ Ğ·Ğ°Ñ‚Ñ€Ğ¾Ğ½ÑƒÑ‚Ğ¾)
subject - Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ° (*Ğ² Ğ¿Ğ¾Ğ²ĞµĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¼ Ğ½Ğ°ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğ¸ -> Ğ·Ğ°ĞºÑ€Ğ¾Ğ¹ Ğ´Ğ²ĞµÑ€ÑŒ, Ğ²Ñ‹Ğ½ĞµÑĞ¸ Ğ¼ÑƒÑĞ¾Ñ€, Ğ¿ĞµÑ€ĞµĞ½ĞµÑĞ¸ ĞºĞ¾Ğ´)
body - Ñ‚ĞµĞ»Ğ¾ ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ°

Current types:
â­ï¸ - New feature (:star:)
ğŸ - Bugfix (:beetle:)
âœ… - Add, update tests (:white_check_mark:)
ğŸš§ - Work in progress (:construction:)
â™»ï¸ - Refactor (:recycle:)
ğŸ“ - Documentation update (:pencil:)
*/

const matchAnyEmojiWithSpaceAfter =
  /(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])\s/;
const matchOptionalTicketNumberWithSpaceAfter = /(\[(T-\d+)\]\s)/; // "[T-4605] ", "[T-1]"
const subjectThatDontStartWithBracket = /([|].+)/; // "Add tests" but

module.exports = {
  extends: ['@commitlint/config-conventional'],
  parserPreset: {
    parserOpts: {
      headerPattern: new RegExp(
        '^' +
          matchAnyEmojiWithSpaceAfter.source +
          matchOptionalTicketNumberWithSpaceAfter.source +
          subjectThatDontStartWithBracket.source +
          '$',
      ),
      headerCorrespondence: ['type', 'ticket', 'subject'],
    },
  },

  plugins: [
    {
      rules: {
        'header-match-team-pattern': (parsed) => {
          const { emoji, ticket, subject } = parsed;
          if (emoji === null && ticket === null && subject === null) {
            return [false, "header must be in format 'âœ… [T-4605] Add tests' or 'âœ… Add tests'"];
          }
          return [true, ''];
        },
      },
    },
  ],

  rules: {
    'header-match-team-pattern': [2, 'always'],
    'type-empty': [0, 'never'],
    'subject-empty': [0, 'never'],
    'subject-case': [0, 'never'],
    'header-max-length': [0, 'never'],
    'type-enum': [2, 'always', ['â­ï¸', 'ğŸ', 'âœ…', 'ğŸš§', 'â™»ï¸', 'ğŸ“']],
  },
};
